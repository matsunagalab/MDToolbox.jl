# TrjArray type

MDToolbox.jl uses a unique type, called `TrjArray`, for storing and processing MD data. 
When you load MD data with `mdload()`, `mdload()` always generates a variable of `TrjArray` type.
Alternatively, a TrjArray variable can be manually generated by calling its constructor:

```julia
# A TrjArray variable generated by loading MD data
t = mdload("run.dcd")

# Generate a TrjArray by calling its constructor. Here, single atom and its nine-frame coordinates are given. 
t = TrjArray(xyz=rand(10, 3))
```

TrjArray displays the information of its topology and trajectory on the standard ouput for users. For example, the following are the outputs from TrjArray just after loading a pdb file. 

```julia
julia> mdload("1nmr.pdb")
20x1290 TrjArray{Float64, Int64}
| A                          | A                          | A                          |  …   A                          | A                          |
| 1GLY                       | 1GLY                       | 1GLY                       |  …   85VAL                      | 85VAL                      |
| 1N                         | 2CA                        | 3C                         |  …   1289HG22                   | 1290HG23                   |
|    28.53   -26.27   -28.94 |    29.17   -26.75   -27.68 |    29.57   -25.61   -26.77 |  …      -7.86   -13.77     5.44 |    -9.59   -13.85     5.12 |
|    14.90   -22.61   -39.37 |    15.46   -21.51   -38.53 |    14.63   -21.25   -37.29 |        -12.22   -15.81    16.41 |   -13.19   -16.57    17.66 |
|    23.41    -2.86   -46.88 |    22.10    -3.25   -47.48 |    21.09    -3.72   -46.45 |        -20.27   -10.55    13.26 |   -18.87   -11.64    13.29 |
|    32.55     2.61   -26.67 |    33.27     3.91   -26.53 |    34.03     4.01   -25.23 |        -17.33   -15.69    15.29 |   -18.58   -15.84    16.52 |
|    28.06    -2.79     6.71 |    26.82    -2.08     7.14 |    25.79    -1.99     6.03 |        -15.29    -8.49     7.07 |   -13.81    -7.58     7.35 |
|    18.58     1.82   -32.61 |    18.49     2.73   -33.78 |    17.08     3.23   -34.03 |  …     -11.52   -13.25    13.40 |   -10.73   -11.69    13.65 |
|    18.83   -25.48   -17.28 |    19.60   -24.35   -17.87 |    20.66   -24.82   -18.85 |         -9.46   -13.49    12.92 |   -10.70   -12.47    13.67 |
|    23.19   -14.27   -19.63 |    24.34   -14.74   -18.81 |    24.34   -14.16   -17.41 |        -15.02   -11.41     7.39 |   -16.62   -11.77     8.03 |
|    13.03     4.56   -33.69 |    13.94     4.98   -34.80 |    14.57     6.34   -34.54 |         -8.15   -13.56    16.57 |    -7.91   -12.72    18.11 |
|    33.84   -12.66   -35.98 |    33.07   -12.78   -34.72 |    33.80   -12.20   -33.53 |        -26.30    -5.86    15.89 |   -27.17    -5.87    14.35 |
|    16.87    -4.29   -29.61 |    17.68    -4.56   -30.84 |    18.55    -3.38   -31.22 |  …     -12.64    -9.46    13.16 |   -12.40   -10.92    14.13 |
|    -0.75    -1.61   -29.23 |     0.53    -1.27   -28.55 |     1.75    -1.63   -29.38 |        -13.61   -13.56    20.23 |   -12.35   -14.79    20.13 |
|    18.30    -7.25   -33.42 |    19.19    -8.43   -33.59 |    19.44    -9.15   -32.28 |        -16.17   -16.37    14.80 |   -16.02   -14.71    15.36 |
|     5.11   -12.01   -17.20 |     6.47   -11.52   -17.57 |     6.77   -11.71   -19.04 |         -4.85    -9.56     8.53 |    -3.89    -9.68    10.00 |
|    25.43     1.83   -30.51 |    26.00     1.39   -31.81 |    26.16     2.54   -32.79 |        -23.89    -7.36    17.90 |   -22.18    -7.18    18.30 |
|    12.85   -11.80   -35.78 |    11.42   -11.45   -35.56 |    11.08   -11.26   -34.10 |  …     -24.66     0.20    14.78 |   -23.75    -1.22    15.28 |
|    16.98     0.72   -33.26 |    16.95     0.68   -34.75 |    16.06    -0.43   -35.28 |        -13.51   -12.24    21.06 |   -13.74   -13.90    20.52 |
|    15.89    -2.89   -34.57 |    14.46    -2.58   -34.81 |    13.54    -3.75   -34.51 |        -14.64    -5.21     8.71 |   -15.94    -5.95     9.64 |
|    30.24    11.26   -16.06 |    30.76    12.62   -15.76 |    30.91    13.47   -17.00 |         -6.57   -15.12    20.61 |    -7.38   -15.35    19.06 |
|    28.91    17.14   -29.35 |    27.45    17.34   -29.54 |    26.67    17.19   -28.25 |        -21.13   -14.49    14.75 |   -21.74   -14.16    13.12 |
```

Here, the first three rows display topology infomation. The 1st row shows chain IDs and names. The 2nd row shows residue IDs and names. The 3rd row shows atom IDs and names. 

The rest of the rows display the coordinates of each atoms. Different rows corresponds to different frames. So, the coordinates of a single structure are described in a single row. 


The users can directly access to the topology and trajectory data contained in a TrjArray variable. 



Trajectory variable is a matrix whose row vectors consist of
coordinate variables. The rows represent frames in the trajectory. 
For simulation data, the sequence of frames represents molecular dynamics. 

Thus, for example, the coordinate at the 10th frame is extracted by
::
  
  crd = trj(10, :);

Translation in the x-axis throughout all frames is coded as
::
  
  trj(:, 1:3:end) = trj(:, 1:3:end) + 3.0;

Average coordinate over all frames (without fitting) is obtained by
::
  
  crd = mean(trj);
