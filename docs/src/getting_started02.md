# TrjArray type

MDToolbox.jl uses a unique type, called `TrjArray`, for storing and processing MD trajectory data. 
When you load MD data with `mdload()`, `mdload()` always generates a variable of `TrjArray` type.
Alternatively, a `TrjArray`-type variable can be manually generated by calling its constructor:

```julia
# A TrjArray variable generated by loading MD data
t = mdload("run.dcd")

# Generate a TrjArray by calling its constructor. Here, single atom and its nine-frame coordinates are given. 
t = TrjArray(xyz=rand(10, 3))
```

`TrjArray` displays the information of its topology and trajectory on the standard ouput for users. For example, the following are the outputs from `TrjArray` just after loading a pdb file. 

```julia
t = readpdb("data/3gb1.pdb")
    32x855 TrjArray{Float64, Int64}
    | A                          | A                          |  …   A                          |
    | 1MET                       | 1MET                       |  …   56GLU                      |
    | 1N                         | 2CA                        |  …   855HG3                     |
    |   -13.15    -1.71     5.51 |   -12.20    -2.85     5.70 |  …      10.24     2.24    -4.53 |
    |   -13.16    -2.75     4.19 |   -12.38    -3.43     5.26 |         10.29     1.79    -3.20 |
    |   -13.26    -2.20     5.12 |   -12.23    -3.26     5.29 |         11.09     3.24    -6.13 |
    |   -12.45    -4.30     6.28 |   -12.25    -3.22     5.28 |         11.75     2.57    -3.31 |
    |   -13.05    -1.52     5.31 |   -12.15    -2.68     5.56 |         10.46     1.51    -3.50 |
    |   -12.98    -3.74     6.65 |   -12.43    -3.31     5.34 |  …      11.26     3.06    -3.59 |
    |   -13.03    -2.10     3.64 |   -12.47    -2.79     4.83 |         10.38     1.53    -3.30 |
    |   -13.00    -2.17     5.21 |   -12.09    -3.19     5.78 |         11.32     3.37    -5.78 |
    |   -12.57    -2.96     3.87 |   -12.12    -3.42     5.21 |         10.36     1.38    -3.53 |
    |   -12.60    -2.85     4.27 |   -12.16    -3.02     5.68 |         10.44     1.40    -3.37 |
    |   -13.12    -1.61     4.72 |   -12.34    -2.60     5.52 |  …      10.96     3.58    -5.68 |
    |             ⋮              |             ⋮              |  ⋱               ⋮              |
    |   -13.46    -2.54     6.05 |   -12.41    -3.14     5.18 |         10.33     1.63    -3.72 |
    |   -12.61    -4.31     6.34 |   -12.22    -3.51     5.15 |         10.26     1.56    -3.59 |
    |   -13.24    -2.72     6.28 |   -12.16    -3.34     5.45 |         11.30     2.91    -3.41 |
    |   -13.21    -2.29     5.61 |   -12.13    -3.31     5.53 |         11.76     2.84    -5.65 |
    |   -12.75    -2.42     4.33 |   -12.22    -2.96     5.61 |  …      11.53     3.05    -5.67 |
    |   -13.32    -2.12     5.10 |   -12.27    -3.17     5.25 |         10.38     1.88    -3.32 |
    |   -13.07    -2.31     4.32 |   -12.27    -3.22     5.19 |         11.65     3.11    -5.90 |
    |   -12.76    -3.69     6.68 |   -12.11    -3.33     5.38 |         11.51     2.97    -5.63 |
    |   -13.21    -2.55     5.53 |   -12.06    -3.41     5.11 |         10.26     1.60    -3.20 |
    |   -13.13    -2.12     4.11 |   -12.34    -3.00     5.02 |  …      12.68     3.28    -4.88 |
    |   -12.81    -2.86     4.32 |   -12.23    -3.33     5.62 |          9.98     2.33    -5.34 |
```

Here, the first three rows display the topology information contained in the `TrjArray`-type variable `t`. The 1st row shows chain IDs and names. 
The 2nd row shows residue IDs and names. The 3rd row shows atom IDs and names. 

The rest of the rows are the XYZ coordinates of atoms. The rows represent frames of the trajectory. So, the coordinates of each structure are contained in the respective row. 

Users can directly access the topology and trajectory data contained in a `TrjArray`-type variable. For example, atom names can be accessed from `t.atomname`

```julia
t.atomname
    855-element Vector{String}:
    "N"
    "CA"
    "C"
    "O"
    ⋮
    "HB2"
    "HB3"
    "HG2"
    "HG3"
```

Likewise, residue names can be accessed from `t.resname`

```julia
t.resid
    855-element Vector{Int64}:
      1
      1
      1
      1
      ⋮
     56
     56
     56
     56
```

XYZ coordinates of atoms at every frames are storec in `t.xyz`. 

`TrjArray` containes the following variables:

|  variable name  | type                               |    content                         |
| --------------- | ---------------------------------- | ---------------------------------- |    
| natom           |  Int                               | The number of atoms                |
| nframe          |  Int                               | The number of frames or structures |
| xyz             |  nframe x (natom*3) Matrix{Float}  | XYZ coordinates of atoms           |
| boxsize         |  nframe x 3 Matrix{Float}          | XYZ size of simulation box         |
| chainname       |  natom Vector{String}              | Chain names                        |
| chainid         |  natom Vector{Int}                 | Chain IDs                          |
| resname         |  natom Vector{String}              | Resisude names                     |
| resid           |  natom Vector{Int}                 | Residue IDs                        |
| atomname        |  natom Vector{String}              | Atom names                         |
| atomid          |  natom Vector{Int}                 | Atom IDs                           |
| mass            |  natom Vector{Float}               | Masses                             |
| radius          |  natom Vector{Float}               | VDW radii of atoms                 |
| charge          |  natom Vector{Float}               | Partial chages of atoms            |
| sasa            |  natom Vector{Float}               | Solvent accessible surface areas   |
| list_bond       |  nbond x 2 Matrix{Int}             | Atom ID pairs for bonds            |
| list_angle      |  nangle x 2 Matrix{Int}            | Atom ID triples for angles         |
| list_dihedral   |  ndihedral x 2 Matrix{Int}         | Atom ID quadruplets for dihedrals  |
| list_improper   |  nimproper x 2 Matrix{Int}         | Atom ID quadruplets for impropers  |
| list_cmap       |  ncmap x 2 Matrix{Int}             | Atom ID quadruplets for cmaps      |

For example, the coordinate at the 10th frame is extracted by
 
  crd = trj(10, :);

Translation in the x-axis throughout all frames is coded as
::
  
  trj(:, 1:3:end) = trj(:, 1:3:end) + 3.0;

Average coordinate over all frames (without fitting) is obtained by
::
  
  crd = mean(trj);
