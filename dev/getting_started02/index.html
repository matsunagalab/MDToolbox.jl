<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TrjArray type · MDToolbox.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MDToolbox.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MDToolbox.jl</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../getting_started01/">Input and Output</a></li><li class="is-active"><a class="tocitem" href>TrjArray type</a></li><li><a class="tocitem" href="../getting_started03/">Atom selection</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../superimpose_rmsd/">Superimpose and RMSD</a></li><li><a class="tocitem" href="../free_energy_surface/">Free energy surface from MD data</a></li><li><a class="tocitem" href="../wham/">WHAM (Weighted Histogram Analysis Method)</a></li></ul></li><li><span class="tocitem">References</span><ul><li><a class="tocitem" href="../fileio/">File IO</a></li><li><a class="tocitem" href="../structure/">Structural computations</a></li><li><a class="tocitem" href="../reduction/">Reductions</a></li><li><a class="tocitem" href="../wham/">WHAM (Weighted Histogram Analysis Method)</a></li><li><a class="tocitem" href="../mbar/">MBAR (Multistate Bennett acceptance ratio)</a></li><li><a class="tocitem" href="../msm/">Makorv state models</a></li></ul></li><li><a class="tocitem" href="../workflow_for_developers/">Workflow for developers</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting started</a></li><li class="is-active"><a href>TrjArray type</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>TrjArray type</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/matsunagalab/MDToolbox.jl/blob/master/docs/src/getting_started02.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TrjArray-type"><a class="docs-heading-anchor" href="#TrjArray-type">TrjArray type</a><a id="TrjArray-type-1"></a><a class="docs-heading-anchor-permalink" href="#TrjArray-type" title="Permalink"></a></h1><p>MDToolbox.jl uses a unique type, called <code>TrjArray</code>, for storing and processing MD trajectory data.  When you load MD data with <code>mdload()</code>, <code>mdload()</code> always generates a variable of <code>TrjArray</code> type. Alternatively, a <code>TrjArray</code>-type variable can be manually generated by calling its constructor:</p><pre><code class="language-julia"># A TrjArray variable generated by loading MD data
t = mdload(&quot;run.dcd&quot;)

# Generate a TrjArray by calling its constructor. Here, single atom and its nine-frame coordinates are given. 
t = TrjArray(xyz=rand(10, 3))</code></pre><p><code>TrjArray</code> displays the information of its topology and trajectory on the standard ouput for users. For example, the following are the outputs from <code>TrjArray</code> just after loading a pdb file. </p><pre><code class="language-julia">t = readpdb(&quot;data/3gb1.pdb&quot;)
    32x855 TrjArray{Float64, Int64}
    | A                          | A                          |  …   A                          |
    | 1MET                       | 1MET                       |  …   56GLU                      |
    | 1N                         | 2CA                        |  …   855HG3                     |
    |   -13.15    -1.71     5.51 |   -12.20    -2.85     5.70 |  …      10.24     2.24    -4.53 |
    |   -13.16    -2.75     4.19 |   -12.38    -3.43     5.26 |         10.29     1.79    -3.20 |
    |   -13.26    -2.20     5.12 |   -12.23    -3.26     5.29 |         11.09     3.24    -6.13 |
    |   -12.45    -4.30     6.28 |   -12.25    -3.22     5.28 |         11.75     2.57    -3.31 |
    |   -13.05    -1.52     5.31 |   -12.15    -2.68     5.56 |         10.46     1.51    -3.50 |
    |   -12.98    -3.74     6.65 |   -12.43    -3.31     5.34 |  …      11.26     3.06    -3.59 |
    |   -13.03    -2.10     3.64 |   -12.47    -2.79     4.83 |         10.38     1.53    -3.30 |
    |   -13.00    -2.17     5.21 |   -12.09    -3.19     5.78 |         11.32     3.37    -5.78 |
    |   -12.57    -2.96     3.87 |   -12.12    -3.42     5.21 |         10.36     1.38    -3.53 |
    |   -12.60    -2.85     4.27 |   -12.16    -3.02     5.68 |         10.44     1.40    -3.37 |
    |   -13.12    -1.61     4.72 |   -12.34    -2.60     5.52 |  …      10.96     3.58    -5.68 |
    |             ⋮              |             ⋮              |  ⋱               ⋮              |
    |   -13.46    -2.54     6.05 |   -12.41    -3.14     5.18 |         10.33     1.63    -3.72 |
    |   -12.61    -4.31     6.34 |   -12.22    -3.51     5.15 |         10.26     1.56    -3.59 |
    |   -13.24    -2.72     6.28 |   -12.16    -3.34     5.45 |         11.30     2.91    -3.41 |
    |   -13.21    -2.29     5.61 |   -12.13    -3.31     5.53 |         11.76     2.84    -5.65 |
    |   -12.75    -2.42     4.33 |   -12.22    -2.96     5.61 |  …      11.53     3.05    -5.67 |
    |   -13.32    -2.12     5.10 |   -12.27    -3.17     5.25 |         10.38     1.88    -3.32 |
    |   -13.07    -2.31     4.32 |   -12.27    -3.22     5.19 |         11.65     3.11    -5.90 |
    |   -12.76    -3.69     6.68 |   -12.11    -3.33     5.38 |         11.51     2.97    -5.63 |
    |   -13.21    -2.55     5.53 |   -12.06    -3.41     5.11 |         10.26     1.60    -3.20 |
    |   -13.13    -2.12     4.11 |   -12.34    -3.00     5.02 |  …      12.68     3.28    -4.88 |
    |   -12.81    -2.86     4.32 |   -12.23    -3.33     5.62 |          9.98     2.33    -5.34 |</code></pre><p>Here, the first three rows display the topology information contained in the <code>TrjArray</code>-type variable <code>t</code>. The 1st row shows chain IDs and names.  The 2nd row shows residue IDs and names. The 3rd row shows atom IDs and names. </p><p>The rest of the rows are the XYZ coordinates of atoms. The rows represent frames of the trajectory. So, the coordinates of each structure are contained in the respective row. </p><p>Users can directly access the topology and trajectory data contained in a <code>TrjArray</code>-type variable. For example, atom names can be accessed from <code>t.atomname</code></p><pre><code class="language-julia">t.atomname
    855-element Vector{String}:
    &quot;N&quot;
    &quot;CA&quot;
    &quot;C&quot;
    &quot;O&quot;
    ⋮
    &quot;HB2&quot;
    &quot;HB3&quot;
    &quot;HG2&quot;
    &quot;HG3&quot;</code></pre><p>Likewise, residue names can be accessed from <code>t.resname</code></p><pre><code class="language-julia">t.resid
    855-element Vector{Int64}:
      1
      1
      1
      1
      ⋮
     56
     56
     56
     56</code></pre><p>XYZ coordinates of atoms at every frames are storec in <code>t.xyz</code>. </p><p><code>TrjArray</code> containes the following variables:</p><table><tr><th style="text-align: right">variable name</th><th style="text-align: right">type</th><th style="text-align: right">content</th></tr><tr><td style="text-align: right">natom</td><td style="text-align: right">Int</td><td style="text-align: right">The number of atoms</td></tr><tr><td style="text-align: right">nframe</td><td style="text-align: right">Int</td><td style="text-align: right">The number of frames or structures</td></tr><tr><td style="text-align: right">xyz</td><td style="text-align: right">nframe x (natom*3) Matrix{Float}</td><td style="text-align: right">XYZ coordinates of atoms</td></tr><tr><td style="text-align: right">boxsize</td><td style="text-align: right">nframe x 3 Matrix{Float}</td><td style="text-align: right">XYZ size of simulation box</td></tr><tr><td style="text-align: right">chainname</td><td style="text-align: right">natom Vector{String}</td><td style="text-align: right">Chain names</td></tr><tr><td style="text-align: right">chainid</td><td style="text-align: right">natom Vector{Int}</td><td style="text-align: right">Chain IDs</td></tr><tr><td style="text-align: right">resname</td><td style="text-align: right">natom Vector{String}</td><td style="text-align: right">Resisude names</td></tr><tr><td style="text-align: right">resid</td><td style="text-align: right">natom Vector{Int}</td><td style="text-align: right">Residue IDs</td></tr><tr><td style="text-align: right">atomname</td><td style="text-align: right">natom Vector{String}</td><td style="text-align: right">Atom names</td></tr><tr><td style="text-align: right">atomid</td><td style="text-align: right">natom Vector{Int}</td><td style="text-align: right">Atom IDs</td></tr><tr><td style="text-align: right">mass</td><td style="text-align: right">natom Vector{Float}</td><td style="text-align: right">Masses</td></tr><tr><td style="text-align: right">radius</td><td style="text-align: right">natom Vector{Float}</td><td style="text-align: right">VDW radii of atoms</td></tr><tr><td style="text-align: right">charge</td><td style="text-align: right">natom Vector{Float}</td><td style="text-align: right">Partial chages of atoms</td></tr><tr><td style="text-align: right">sasa</td><td style="text-align: right">natom Vector{Float}</td><td style="text-align: right">Solvent accessible surface areas</td></tr><tr><td style="text-align: right">list_bond</td><td style="text-align: right">nbond x 2 Matrix{Int}</td><td style="text-align: right">Atom ID pairs for bonds</td></tr><tr><td style="text-align: right">list_angle</td><td style="text-align: right">nangle x 2 Matrix{Int}</td><td style="text-align: right">Atom ID triples for angles</td></tr><tr><td style="text-align: right">list_dihedral</td><td style="text-align: right">ndihedral x 2 Matrix{Int}</td><td style="text-align: right">Atom ID quadruplets for dihedrals</td></tr><tr><td style="text-align: right">list_improper</td><td style="text-align: right">nimproper x 2 Matrix{Int}</td><td style="text-align: right">Atom ID quadruplets for impropers</td></tr><tr><td style="text-align: right">list_cmap</td><td style="text-align: right">ncmap x 2 Matrix{Int}</td><td style="text-align: right">Atom ID quadruplets for cmaps</td></tr></table><p>For example, the coordinate at the 10th frame is extracted by</p><p>crd = trj(10, :);</p><p>Translation in the x-axis throughout all frames is coded as ::</p><p>trj(:, 1:3:end) = trj(:, 1:3:end) + 3.0;</p><p>Average coordinate over all frames (without fitting) is obtained by ::</p><p>crd = mean(trj);</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started01/">« Input and Output</a><a class="docs-footer-nextpage" href="../getting_started03/">Atom selection »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 5 May 2021 11:50">Wednesday 5 May 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
