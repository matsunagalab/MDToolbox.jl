<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TrjArray type · MDToolbox.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MDToolbox.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MDToolbox.jl</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../getting_started01/">Input and Output</a></li><li class="is-active"><a class="tocitem" href>TrjArray type</a></li><li><a class="tocitem" href="../getting_started03/">Atom selection</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../superimpose_rmsd/">Superimpose and RMSD</a></li><li><a class="tocitem" href="../free_energy_surface/">Free energy surface from MD data</a></li><li><a class="tocitem" href="../wham_example/">WHAM (Weighted Histogram Analysis Method)</a></li></ul></li><li><span class="tocitem">References</span><ul><li><a class="tocitem" href="../fileio/">File IO</a></li><li><a class="tocitem" href="../structure/">Structural computations</a></li><li><a class="tocitem" href="../reduction/">Reductions</a></li><li><a class="tocitem" href="../wham/">WHAM (Weighted Histogram Analysis Method)</a></li><li><a class="tocitem" href="../mbar/">MBAR (Multistate Bennett acceptance ratio)</a></li><li><a class="tocitem" href="../msm/">Makorv state models</a></li></ul></li><li><a class="tocitem" href="../workflow_for_developers/">Workflow for developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting started</a></li><li class="is-active"><a href>TrjArray type</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>TrjArray type</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/matsunagalab/MDToolbox.jl/blob/master/docs/src/getting_started02.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TrjArray-type"><a class="docs-heading-anchor" href="#TrjArray-type">TrjArray type</a><a id="TrjArray-type-1"></a><a class="docs-heading-anchor-permalink" href="#TrjArray-type" title="Permalink"></a></h1><p>MDToolbox.jl introduces a unique type, called <code>TrjArray</code>, for storing and processing MD trajectory data.  When you load MD data with <code>mdload()</code>, <code>mdload()</code> always generates a new variable with <code>TrjArray</code> type. Alternatively, a <code>TrjArray</code>-type variable can be manually generated by calling its constructor.</p><pre><code class="language-julia">using MDToolbox
ENV[&quot;COLUMNS&quot;] = 130; # if you are using Jupyter, the column width should be set for the message width from MDToolbox.jl.

# A TrjArray variable generated by loading MD data
t = mdload(&quot;examples/data/md_alad/3_prod/run.nc&quot;);

# Generate a TrjArray by calling its constructor. Here, single atom and its nine-frame coordinates are given. 
t = TrjArray(xyz=rand(10, 3));</code></pre><p><code>TrjArray</code> displays the information of its topology and trajectory on the standard ouput for users. For example, the following are the outputs from <code>TrjArray</code> just after loading a pdb file. </p><pre><code class="language-julia">t = mdload(&quot;examples/data/3gb1.pdb&quot;)
    32x855 TrjArray{Float64, Int64}
    | A                          | A                          |  …   A                          |
    | 1MET                       | 1MET                       |  …   56GLU                      |
    | 1N                         | 2CA                        |  …   855HG3                     |
    |   -13.15    -1.71     5.51 |   -12.20    -2.85     5.70 |  …      10.24     2.24    -4.53 |
    |   -13.16    -2.75     4.19 |   -12.38    -3.43     5.26 |         10.29     1.79    -3.20 |
    |   -13.26    -2.20     5.12 |   -12.23    -3.26     5.29 |         11.09     3.24    -6.13 |
    |   -12.45    -4.30     6.28 |   -12.25    -3.22     5.28 |         11.75     2.57    -3.31 |
    |   -13.05    -1.52     5.31 |   -12.15    -2.68     5.56 |         10.46     1.51    -3.50 |
    |   -12.98    -3.74     6.65 |   -12.43    -3.31     5.34 |  …      11.26     3.06    -3.59 |
    |   -13.03    -2.10     3.64 |   -12.47    -2.79     4.83 |         10.38     1.53    -3.30 |
    |   -13.00    -2.17     5.21 |   -12.09    -3.19     5.78 |         11.32     3.37    -5.78 |
    |   -12.57    -2.96     3.87 |   -12.12    -3.42     5.21 |         10.36     1.38    -3.53 |
    |   -12.60    -2.85     4.27 |   -12.16    -3.02     5.68 |         10.44     1.40    -3.37 |
    |   -13.12    -1.61     4.72 |   -12.34    -2.60     5.52 |  …      10.96     3.58    -5.68 |
    |             ⋮              |             ⋮              |  ⋱               ⋮              |
    |   -13.46    -2.54     6.05 |   -12.41    -3.14     5.18 |         10.33     1.63    -3.72 |
    |   -12.61    -4.31     6.34 |   -12.22    -3.51     5.15 |         10.26     1.56    -3.59 |
    |   -13.24    -2.72     6.28 |   -12.16    -3.34     5.45 |         11.30     2.91    -3.41 |
    |   -13.21    -2.29     5.61 |   -12.13    -3.31     5.53 |         11.76     2.84    -5.65 |
    |   -12.75    -2.42     4.33 |   -12.22    -2.96     5.61 |  …      11.53     3.05    -5.67 |
    |   -13.32    -2.12     5.10 |   -12.27    -3.17     5.25 |         10.38     1.88    -3.32 |
    |   -13.07    -2.31     4.32 |   -12.27    -3.22     5.19 |         11.65     3.11    -5.90 |
    |   -12.76    -3.69     6.68 |   -12.11    -3.33     5.38 |         11.51     2.97    -5.63 |
    |   -13.21    -2.55     5.53 |   -12.06    -3.41     5.11 |         10.26     1.60    -3.20 |
    |   -13.13    -2.12     4.11 |   -12.34    -3.00     5.02 |  …      12.68     3.28    -4.88 |
    |   -12.81    -2.86     4.32 |   -12.23    -3.33     5.62 |          9.98     2.33    -5.34 |</code></pre><p>Here, the first three rows display the topology information contained in the <code>TrjArray</code>-type variable <code>t</code>. The 1st row shows chain IDs and names.  The 2nd row shows residue IDs and names. The 3rd row shows atom IDs and names. </p><p>The rest of the rows are the XYZ coordinates of atoms. The rows represent frames of the trajectory. So, the coordinates of each structure are contained in the respective row. </p><p>Users can directly access the topology and trajectory data contained in a <code>TrjArray</code>-type variable. For example, atom names can be accessed from <code>t.atomname</code></p><pre><code class="language-julia">t.atomname
    855-element Vector{String}:
    &quot;N&quot;
    &quot;CA&quot;
    &quot;C&quot;
    &quot;O&quot;
    ⋮
    &quot;HB2&quot;
    &quot;HB3&quot;
    &quot;HG2&quot;
    &quot;HG3&quot;</code></pre><p>Likewise, residue names can be accessed from <code>t.resname</code></p><pre><code class="language-julia">t.resid
    855-element Vector{Int64}:
      1
      1
      1
      1
      ⋮
     56
     56
     56
     56</code></pre><p>XYZ coordinates of atoms at every frames are stored in <code>t.xyz</code> as a Matrix (2-dimensional Array). </p><pre><code class="language-julia">t.xyz
  32×2565 Array{Float64,2}:
   -13.148  -1.712  5.506  -12.204  -2.845  5.703  -10.787  …  -5.015  11.4    2.981  -5.635  10.243  2.242  -4.528
   -13.157  -2.751  4.188  -12.383  -3.431  5.265  -11.062     -4.948  10.403  2.845  -4.607  10.289  1.786  -3.203
   -13.263  -2.198  5.124  -12.234  -3.262  5.291  -10.878     -3.987  12.803  2.829  -6.066  11.088  3.244  -6.129
   -12.447  -4.303  6.284  -12.247  -3.222  5.278  -10.903     -5.088  10.448  1.461  -3.727  11.753  2.573  -3.312
   -13.048  -1.516  5.314  -12.149  -2.68   5.56   -10.728     -5.194  10.528  2.313  -5.067  10.462  1.511  -3.498
     ⋮                                      ⋮               ⋱                  ⋮                             
   -12.758  -3.689  6.677  -12.112  -3.327  5.385  -10.767     -3.783  13.174  2.414  -5.77   11.507  2.972  -5.631
   -13.206  -2.549  5.527  -12.063  -3.411  5.11   -10.744     -5.049  10.311  2.8    -4.493  10.257  1.6    -3.201
   -13.127  -2.119  4.107  -12.343  -3.001  5.019  -10.998  …  -4.007  11.853  2.636  -6.3    12.676  3.277  -4.88
   -12.809  -2.858  4.322  -12.235  -3.325  5.615  -10.889     -5.346  10.808  2.939  -3.91    9.983  2.325  -5.343</code></pre><p>Here, a row vector are the XYZ coordinates of atoms in order</p><pre><code class="language-none">x(1) y(1) z(1) x(2) y(2) z(2) .. x(natom) y(natom) z(natom)</code></pre><p>The rows represent frames in the trajectory. For typical MD simulation data, frames are time steps of recorded atomic coordinates. </p><p>For example, the translation of the X coordinates of the system at the 3rd frame can be accessed as follows,</p><pre><code class="language-julia">t.xyz[3, 1:3:end]
  855-element Array{Float64,1}:
   -13.263
   -12.234
   -10.878
   -10.574
   -12.144
     ⋮
    10.754
    12.452
    12.803
    11.088</code></pre><p><code>TrjArray</code> containes the following variables:</p><table><tr><th style="text-align: left">variable name</th><th style="text-align: left">type</th><th style="text-align: left">content</th></tr><tr><td style="text-align: left">natom</td><td style="text-align: left">Int</td><td style="text-align: left">The number of atoms</td></tr><tr><td style="text-align: left">nframe</td><td style="text-align: left">Int</td><td style="text-align: left">The number of frames or structures</td></tr><tr><td style="text-align: left">xyz</td><td style="text-align: left">nframe x (natom*3) Matrix{Float}</td><td style="text-align: left">XYZ coordinates of atoms</td></tr><tr><td style="text-align: left">boxsize</td><td style="text-align: left">nframe x 3 Matrix{Float}</td><td style="text-align: left">XYZ size of simulation box</td></tr><tr><td style="text-align: left">chainname</td><td style="text-align: left">natom Vector{String}</td><td style="text-align: left">Chain names</td></tr><tr><td style="text-align: left">chainid</td><td style="text-align: left">natom Vector{Int}</td><td style="text-align: left">Chain IDs</td></tr><tr><td style="text-align: left">resname</td><td style="text-align: left">natom Vector{String}</td><td style="text-align: left">Resisude names</td></tr><tr><td style="text-align: left">resid</td><td style="text-align: left">natom Vector{Int}</td><td style="text-align: left">Residue IDs</td></tr><tr><td style="text-align: left">atomname</td><td style="text-align: left">natom Vector{String}</td><td style="text-align: left">Atom names</td></tr><tr><td style="text-align: left">atomid</td><td style="text-align: left">natom Vector{Int}</td><td style="text-align: left">Atom IDs</td></tr><tr><td style="text-align: left">mass</td><td style="text-align: left">natom Vector{Float}</td><td style="text-align: left">Masses</td></tr><tr><td style="text-align: left">radius</td><td style="text-align: left">natom Vector{Float}</td><td style="text-align: left">VDW radii of atoms</td></tr><tr><td style="text-align: left">charge</td><td style="text-align: left">natom Vector{Float}</td><td style="text-align: left">Partial chages of atoms</td></tr><tr><td style="text-align: left">sasa</td><td style="text-align: left">natom Vector{Float}</td><td style="text-align: left">Solvent accessible surface areas</td></tr><tr><td style="text-align: left">list_bond</td><td style="text-align: left">nbond x 2 Matrix{Int}</td><td style="text-align: left">Atom ID pairs for bonds</td></tr><tr><td style="text-align: left">list_angle</td><td style="text-align: left">nangle x 2 Matrix{Int}</td><td style="text-align: left">Atom ID triples for angles</td></tr><tr><td style="text-align: left">list_dihedral</td><td style="text-align: left">ndihedral x 2 Matrix{Int}</td><td style="text-align: left">Atom ID quadruplets for dihedrals</td></tr><tr><td style="text-align: left">list_improper</td><td style="text-align: left">nimproper x 2 Matrix{Int}</td><td style="text-align: left">Atom ID quadruplets for impropers</td></tr><tr><td style="text-align: left">list_cmap</td><td style="text-align: left">ncmap x 2 Matrix{Int}</td><td style="text-align: left">Atom ID quadruplets for cmaps</td></tr></table></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../getting_started01/">« Input and Output</a><a class="docs-footer-nextpage" href="../getting_started03/">Atom selection »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 4 January 2022 06:36">Tuesday 4 January 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
