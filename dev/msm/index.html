<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Makorv state models · MDToolbox.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MDToolbox.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MDToolbox.jl</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../getting_started01/">Input and Output</a></li><li><a class="tocitem" href="../getting_started02/">TrjArray type</a></li><li><a class="tocitem" href="../getting_started03/">Atom selection</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../superimpose_rmsd/">Superimpose and RMSD</a></li><li><a class="tocitem" href="../free_energy_surface/">Free energy surface from MD data</a></li><li><a class="tocitem" href="../wham_example/">WHAM (Weighted Histogram Analysis Method)</a></li></ul></li><li><span class="tocitem">References</span><ul><li><a class="tocitem" href="../fileio/">File IO</a></li><li><a class="tocitem" href="../structure/">Structural computations</a></li><li><a class="tocitem" href="../reduction/">Reductions</a></li><li><a class="tocitem" href="../wham/">WHAM (Weighted Histogram Analysis Method)</a></li><li><a class="tocitem" href="../mbar/">MBAR (Multistate Bennett acceptance ratio)</a></li><li class="is-active"><a class="tocitem" href>Makorv state models</a></li></ul></li><li><a class="tocitem" href="../workflow_for_developers/">Workflow for developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">References</a></li><li class="is-active"><a href>Makorv state models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Makorv state models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/matsunagalab/MDToolbox.jl/blob/master/docs/src/msm.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Makorv-state-models"><a class="docs-heading-anchor" href="#Makorv-state-models">Makorv state models</a><a id="Makorv-state-models-1"></a><a class="docs-heading-anchor-permalink" href="#Makorv-state-models" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmgenerate-Tuple{Int64, Any, Any}" href="#MDToolbox.msmgenerate-Tuple{Int64, Any, Any}"><code>MDToolbox.msmgenerate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmgenerate(nframe::Int, T, pi_i)
            states = zeros(typeof(nframe), nframe)</code></pre><p>Randomly samples a state trajectory from the the given transition matrix, and equilibrium probabilities of states. </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; T, pi_i = msmtransitionmatrix(C)
julia&gt; states = msmgenerate(1000, T, pi_i)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L101-L112">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmgenerate-Tuple{Int64, Any, Any, Any}" href="#MDToolbox.msmgenerate-Tuple{Int64, Any, Any, Any}"><code>MDToolbox.msmgenerate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmgenerate(nframe, T, pi_i, emission) -&gt; states, observations</code></pre><p>Randomly samples a state trajectory and observations from the given transition matrix, equilibrium probabilities of states, and emissions.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; T, pi_i = msmtransitionmatrix(C)
julia&gt; states, observations = msmgenerate(1000, T, pi_i, emission)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L123-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmcountmatrix-Tuple{Any}" href="#MDToolbox.msmcountmatrix-Tuple{Any}"><code>MDToolbox.msmcountmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmcountmatrix(indexOfCluster; tau=1) -&gt; C::Matrix</code></pre><p>Transition count matrix from a sinlgle binned trajectory or a set of binned trajectories.  <code>indexOfCluster</code> is a vector or a set of vectors containing binned trajectorie(s).  Returns count matrix for transitions from state i to state j in a time step of tau. </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ta = mdload(&quot;ak.dcd&quot;)
julia&gt; X = compute_distancemap(ta[&quot;atomname CA&quot;])
julia&gt; F = clusterkcenters(X)
julia&gt; c = msmcountmatrix(F.indexOfCluster, tau=10)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L147-L161">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmtransitionmatrix-Tuple{Any}" href="#MDToolbox.msmtransitionmatrix-Tuple{Any}"><code>MDToolbox.msmtransitionmatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmtransitionmatrix(C; TOLERANCE=10^(-4), verbose=true) -&gt; T::Matrix, p::Vector</code></pre><p>Estimate the transition probability matrix from count matrix <code>C</code>.  Detailed balance is implicitly imposed in the estimation. </p><p>Returns the transition probability matrix and the equilibrium probabilities of states. </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ta = mdload(&quot;ak.dcd&quot;)
julia&gt; X = compute_distancemap(ta[&quot;atomname CA&quot;])
julia&gt; F = clusterkcenters(X)
julia&gt; C = msmcountmatrix(F.indexOfCluster, tau=10)
julia&gt; T, p = msmtransitionmatrix(C)</code></pre><p><strong>References</strong></p><pre><code class="language-none">This routines uses the reversible maximum likelihood estimator described in 
K. A. Beauchamp, G. R. Bowman, T. J. Lane, L. Maibaum, I. S. Haque, and V. S. Pande, 
MSMBuilder2: Modeling Conformational Dynamics on the Picosecond to Millisecond Scale, 
J. Chem. Theory Comput. 7, 3412 (2011).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L191-L214">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmviterbi-NTuple{4, Any}" href="#MDToolbox.msmviterbi-NTuple{4, Any}"><code>MDToolbox.msmviterbi</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmviterbi(observation, T, p, emission) -&gt; states::Vector</code></pre><p>Viterbi algorithm estimates the most probable hidden state sequence from the observation data. <code>observations</code> is a set of observed vectors. <code>T</code>, <code>p</code> are the transition probabilities and equilibrium probabilities, respectively.  <code>emission</code> is a matrix whose rows correspond to states, and columns correspond to observations. </p><p>Returns the transition probability matrix, the equilibrium probabilities of states,  and the emission probabilities (though the emission does not change). </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; nframe = 1000
julia&gt; states, observations = msmgenerate(nframe, T, pi_i, emission)
julia&gt; states_estimated = msmviterbi(T, pi_i, emission, observation)</code></pre><p><strong>References</strong></p><pre><code class="language-none">The algorithm of this routines is based on the descriptions in PRML book by C. Bishop. </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L425-L445">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmbaumwelch-NTuple{4, Any}" href="#MDToolbox.msmbaumwelch-NTuple{4, Any}"><code>MDToolbox.msmbaumwelch</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmbaumwelch(observations, T_init, p_init, emission_init; TOLERANCE=10.0^(-4), MAXITERATION=Inf64) -&gt; T::Matrix, p::Vector, emission::Matrix</code></pre><p>Baum-Welch algorithm estimates the most probable transition probabilities from the given observation data.  In this function, detailed balance is implicitly imposed in the estimation,  so the equilibrium probabilities can be determined from the estimated transition probabilities.  Also, unlike the original Baum-Welch algorithm, the emission is NOT estimated in this function,  because the emission probabilites are usually known a priori in cases of molecular experiments.  <code>observations</code> is a set of observed vectors. <code>T_init</code>, <code>p_init</code> are initial transition probabilities and equilibrium probabilities, respectively.  <code>emission_init</code> is a matrix whose rows correspond to states, and columns correspond to observations. </p><p>Returns the transition probability matrix, the equilibrium probabilities of states,  and the emission probabilities (though the emission does not change). </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; ta = mdload(&quot;ak.dcd&quot;)
julia&gt; X = compute_distancemap(ta[&quot;atomname CA&quot;])
julia&gt; F = clusterkcenters(X)
julia&gt; C = msmcountmatrix(F.indexOfCluster, tau=10)
julia&gt; T, p = msmtransitionmatrix(C)</code></pre><p><strong>References</strong></p><pre><code class="language-none">The algorithm of this routines is based on the descriptions in PRML book by C. Bishop. </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L314-L340">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MDToolbox.msmplot-Tuple{Any}" href="#MDToolbox.msmplot-Tuple{Any}"><code>MDToolbox.msmplot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">msmplot(T; pi_i=nothing, x=nothing, y=nothing, filename=nothing, 
        edgewidth_scale=10.0, arrow_scale=0.1, nodesize=0.5, fontsize=10, names=[], dpi=100)</code></pre><p>Visualize the graphical structure of the given Markov state model parameters.  <code>T</code> is a transition probability matrix whose elements Tij represents the probablity of transition from state i to j.  <code>T</code> should satisfy the detailed balance condition. <code>pi_i</code> is a vector whose elements are equilibrium probabilities of states.  <code>x</code> and <code>y</code> are X and Y coordinates of states, respectively. </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; nstate = 5
julia&gt; T, pi_i = msmtransitionmatrix(rand(nstate, nstate))
julia&gt; x = rand(nstate); y = rand(nstate)
julia&gt; msmplot(T, pi_i=pi_i, x=x, y=y)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/matsunagalab/MDToolbox.jl/blob/2f002079c60bca6ef0593915640c637c075e53c4/src/msm.jl#L1-L17">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mbar/">« MBAR (Multistate Bennett acceptance ratio)</a><a class="docs-footer-nextpage" href="../workflow_for_developers/">Workflow for developers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 28 May 2021 10:42">Friday 28 May 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
